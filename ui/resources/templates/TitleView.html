<!doctype html>
<html lang=en xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${title.name + ' - PANDAS'}">Example Title - PANDAS</title>
    <link rel="stylesheet" href="../static/assets/Global.css" th:href="@{/assets/Global.css}">
    <script src="../static/assets/Global.js" th:src="@{/assets/Global.js}" defer></script>
    <style>
        h1 {
            margin-bottom: 8px;
            margin-top: 8px;
        }

        h4 {
            margin-bottom: 16px;
        }

        .panel-title-details {
            float: left;
            width: 450px
        }

        .panel-instance-list .instance-year {
            font-size: 200%;
            font-weight: lighter;
            color: #666;
            padding-right: 40px;
            text-align: left;
            vertical-align: top
        }

        .panel-instance-list .instance-list {
            padding-bottom: 32px;
        }

        .panel-instance-list .instance-list > a {
            display: inline-block;
            text-align: center;
            margin-bottom: 16px;
            margin-right: 8px;
            color: #000;
        }

        .panel-instance-list .instance-list > a img {
            width: 100px;
            height: 75px;
        }
        .panel-instance-list .instance-list > a .size {
            color: #666;
            font-size: 75%;
        }
        .panel-instance-list .instance-list > a .state {
            color: #666;
            font-size: 75%;
        }
    </style>
</head>
<body>
<nav th:replace="_layout.html :: sidebar"></nav>
<main>
    <header>
        <nav>
            <a th:href="@{|/titles/${title.id}/edit|}" class="btn"><i class="icon edit"></i> Edit</a>
            <a th:href="@{|/titles/${title.id}/p3|}" class="btn btn-secondary">View in PANDAS 3</a>
        </nav>
    </header>

    <div class="panel-title-details">
        <h1 th:text="${title.name}">Example Title</h1>
        <a th:href="@{|https://nla.gov.au/nla.arc-${title.pi}|}">nla.arc-<span th:text="${title.pi}"></span></a><br>
        <a th:href="${title.titleUrl}" th:text="${title.titleUrl}" style="color: green"></a>

        <div>
            <h4>Status</h4>
            <div th:text="${title.status.name}" style="text-transform: capitalize"></div>
            <div></span>
            </div>
            <details>
                <summary><span th:text="${title?.gather?.schedule?.name}"></span> <span
                        th:text="${title?.gather?.method?.name}"></span> gather</summary>
                <div th:if="${title?.gather?.nextGatherDate != null}">Next gather date: <time th:text="${dateFormat.format(title.gather.nextGatherDate)}"></time></div>
                <div>Command: <tt th:text="${title?.gather?.buildHttrackCommand()}"></tt></div>
            </details>
        </div>

        <div th:if="${title.publisher != null}">
            <h4>Publisher</h4>
            <a th:href="@{|/publishers/${title.publisher.id}|}" th:text="${title.publisher.name}"></a>
            [<span th:text="${title.publisher.type.name}"></span>]
        </div>

        <div>
            <h4>Collections</h4>
            <ul class="collection-list" style="padding-left: 16px; list-style-type: '- '">
                <li th:each="collection: ${title.collections}">
                    <a th:href="@{/collections/{id}(id=${collection.id})}" th:text="${collection.name}"
                       href="CollectionView.html">Nice Sites</a>
                </li>
            </ul>
        </div>

        <div>
            <h4>Subjects</h4>
            <ul class="subject-list" style="padding-left: 16px; list-style-type: '- '">
                <li th:each="subject: ${title.subjects}">
                    <a th:href="@{/subjects/{id}(id=${subject.id})}" th:text="${subject.name}"
                       href="SubjectView.html">Sport</a>
                </li>
            </ul>
        </div>

        <div>
            <h4>Cataloguing</h4>
            <div>Format: <span th:text="${title.format.name}"></span></div>
            <div th:if="${title.anbdNumber != null}">ANBD No: <a
                    th:href="@{|https://nla.gov.au/anbd.bib-an${title.anbdNumber}|}" th:text="${title.anbdNumber}"></a>
            </div>
            <div th:if="${title.localDatabaseNo != null}">Local DB No: <span th:text="${title.localDatabaseNo}"></span>
            </div>
            <div th:if="${title.localReference != null}">Local Ref: <span th:text="${title.localReference}"></span>
            </div>
        </div>

        <div>
            <h4>Owner</h4>
            <div>Owner: <span th:text="${title?.owner?.fullName}"></span> <a
                    th:href="@{|/titles/${title.id}/ownerhistory|}" href="TitleOwnerHistory.html"><i
                    class="icon history"></i></a></div>
            <div>Agency: <span th:text="${title.agency.name}"></span></div>
            <div>Registered: <span th:text="${dateFormat.format(title.regDate)}"></span></div>
        </div>

        <div>
            <h4>Notes</h4>
            <div th:text="${title.notes}" style="white-space: pre-wrap"></div>
        </div>
    </div>

    <table class="panel-instance-list">
        <tr th:each="year : ${instancesByYear}">
            <td class="instance-year" th:text="${year.key}">2021</td>
            <td class="instance-list">
                <a th:each="instance : ${year.value}"
                   th:href="@{|/instances/${instance.id}|}">
                    <img>
                    <div th:text="${instanceDateFormat.format(instance.date)}"></div>
                    <div class="size" th:text="${instance.gather == null || instance.gather.size == null ? '' : T(org.apache.commons.io.FileUtils).byteCountToDisplaySize(instance.gather.size)}"></div>
                    <div class="state" th:if="${instance.state.name != 'archived'}" th:text="${instance.state.name}"></div>
                </a>
            </td>
        </tr>
    </table>
</main>
