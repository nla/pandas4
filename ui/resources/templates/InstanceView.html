<!doctype html>
<html lang=en xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${instance.dateString + ' - ' + instance.title.name + ' - PANDAS'}">20120402-0944 - Example Title - PANDAS</title>
    <link rel="stylesheet" href="../static/assets/Global.css" th:href="@{/assets/Global.css}">
    <script src="../static/assets/Global.js" th:src="@{/assets/Global.js}" defer></script>
</head>
<body>
<nav th:replace="_layout.html :: sidebar"></nav>
<main>
    <form id="actionForm" method=post></form>
    <header>
        <nav>
            <a th:href="@{|/titles/${instance.title.id}|}" class="btn"><i class="icon back"></i> Back to title</a>
            <button th:if="${instance.canArchive()}" th:formaction="@{|/instances/${instance.id}/archive|}" type=submit form=actionForm class="btn btn-secondary"><i class="icon archive"></i> Archive</button>
        </nav>
        <button th:if="${instance.canDelete()}" th:formaction="@{|/instances/${instance.id}/delete|}" type=submit form=actionForm class="btn btn-danger"><i class="icon delete"></i> Delete</button>
    </header>

    <nav class="breadcrumb">
        <ol>
            <li><a th:href="@{/titles}" href="TitleSearch.html" style="font-weight: bold">Titles</a></li>
            <li><a th:href="@{|/titles/${instance.title.id}|}" href="TitleView.html"
                   th:text="${#strings.abbreviate(instance.title.name, 100)}">My cool title</a></li>
            <li class="active" th:text="${instance.dateString}"></li>
        </ol>
    </nav>

    <h1 th:text="${'Instance ' + instance.dateString}">Instance 20120402-0944</h1>

    <table>
        <tr><th>State:</th><td th:text="${instance.state.name}">gathered</td></tr>
        <tr><th>Method:</th><td th:text="${instance.gatherMethodName}">HTTrack</td></tr>
        <tr><th>Size:</th><td th:text="${instance.gather == null || instance.gather.size == null ? '' : T(org.apache.commons.io.FileUtils).byteCountToDisplaySize(instance.gather.size)}"></td></tr>
        <tr><th>Files:</th><td th:text="${#numbers.formatInteger(instance.gather.files, 0, 'COMMA')}"></td></tr>
        <tr><th>Time:</th><td th:text="${instance?.gather?.timeHuman}"></td></tr>
    </table>

    <style>
        table th { text-align: right; }
    </style>

    <h2 id="state-history">History</h2>
    <table class="history-table">
        <tr th:each="event : ${stateHistory}">
            <td style="text-align: right" th:text="${dateFormat.format(event.startDate)}"></td>
            <td th:text="${event.state.name}"></td>
            <td th:text="${event.individual?.userid ?: '(system)'}"></td>
        </tr>
    </table>

</main>
