# Test-specific configuration for delivery module

# Allow bean definition overriding to fix p6spy-spring-boot-starter 2.0.0 compatibility
# Version 2.0.0 includes conflicting autoconfiguration for DataSourcePoolMetadataProviders
spring.main.allow-bean-definition-overriding=true

# Enable Hibernate DDL auto-update for tests to create tables
spring.jpa.hibernate.ddl-auto=update

# Ensure data.sql runs AFTER Hibernate creates the schema
# This overrides the main application.properties setting
spring.jpa.defer-datasource-initialization=true

# Configure Hibernate Search for tests with in-memory backend
spring.jpa.properties.hibernate.search.enabled=true
spring.jpa.properties.hibernate.search.backend.type=lucene
spring.jpa.properties.hibernate.search.backend.directory.type=local-heap
spring.jpa.properties.hibernate.search.backend.directory.root=${java.io.tmpdir}/lucene-test
spring.jpa.properties.hibernate.search.backend.analysis.configurer=pandas.search.SearchAnalysisConfig
